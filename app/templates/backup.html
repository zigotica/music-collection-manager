{% extends "base.html" %}

{% block title %}Backup & Export - Music Library{% endblock %}

{% block content %}
<div class="page-header">
    <h1>Backup & Export</h1>
</div>

{% if message %}
<div class="alert alert-success">{{ message }}</div>
{% endif %}

{% if error %}
<div class="alert alert-error">{{ error }}</div>
{% endif %}

<div class="admin-section">
    <h2>Backup Statistics</h2>
    <div class="stats-grid">
        <div class="stat-card">
            <span class="stat-value">{{ stats.album_count }}</span>
            <span class="stat-label">Albums</span>
        </div>
        <div class="stat-card">
            <span class="stat-value">{{ stats.artist_count }}</span>
            <span class="stat-label">Artists</span>
        </div>
        <div class="stat-card">
            <span class="stat-value">{{ stats.covers_count }}</span>
            <span class="stat-label">Covers</span>
        </div>
        <div class="stat-card">
            <span class="stat-value">{{ stats.artist_images_count }}</span>
            <span class="stat-label">Artist Images</span>
        </div>
    </div>
</div>

<div class="admin-section">
    <h2>Export</h2>
    <div class="import-grid">
        <div class="import-card">
            <h3>Database</h3>
            <p>Export your PostgreSQL database as SQL dump file</p>
            <a href="/admin/backup/database" class="btn btn-primary">Download Database</a>
        </div>
        
        <div class="import-card">
            <h3>Images</h3>
            <p>Download all album covers and artist images as ZIP</p>
            <a href="/admin/backup/images" class="btn btn-primary">Download Images</a>
        </div>
    </div>
</div>

<div class="admin-section">
    <h2>Restore</h2>
    <div class="import-grid">
        <div class="import-card">
            <h3>Database</h3>
            <p>Restore database from a SQL dump file</p>
            <form action="/admin/restore/database" method="post" enctype="multipart/form-data">
                <input type="file" name="file" accept=".sql" required>
                <button type="submit" class="btn btn-primary">Upload SQL File</button>
            </form>
        </div>
        
        <div class="import-card">
            <h3>Covers</h3>
            <p>Restore album cover images</p>
            <form action="/admin/restore/covers" method="post" enctype="multipart/form-data">
                <input type="file" name="files" accept="image/*" multiple required>
                <button type="submit" class="btn btn-primary">Upload Covers</button>
            </form>
        </div>
        
        <div class="import-card">
            <h3>Artists</h3>
            <p>Restore artist images</p>
            <form action="/admin/restore/artists" method="post" enctype="multipart/form-data">
                <input type="file" name="files" accept="image/*" multiple required>
                <button type="submit" class="btn btn-primary">Upload Artists</button>
            </form>
        </div>
    </div>
    <p class="help-text" style="margin-top: 15px;">
        <strong>Warning:</strong> Restoring will overwrite existing data. Make sure to create a backup first.
    </p>
</div>

<div class="toolbar" style="margin-top: 20px;">
    <a href="/admin" class="btn">‚Üê Back to Admin</a>
</div>
{% endblock %}
