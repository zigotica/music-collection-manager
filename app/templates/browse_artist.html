{% extends "base.html" %}

{% block title %}{{ artist_name }} - Music Library{% endblock %}

{% block content %}
<div class="artist-header">
    {% if artist and artist.image_url %}
    <img src="{{ ARTISTS_URL }}{{ artist.image_url }}" alt="{{ artist_name }}" class="artist-image">
    {% else %}
    <div class="artist-image artist-image-placeholder">
        <span>{{ artist_name[0] }}</span>
    </div>
    {% endif %}
    
    <div class="artist-info">
        <h1>{{ artist_name }}</h1>
        <span class="count">{{ albums|length }} albums</span>
        
        {% if artist and artist.genres %}
        <div class="artist-genres">
            {% for genre in artist.genres[:5] %}
            <a href="/genre/{{ genre }}" class="tag">{{ genre }}</a>
            {% endfor %}
        </div>
        {% endif %}
        
        {% if artist and artist.bio %}
        <p class="artist-bio">{{ artist.bio }}</p>
        {% endif %}
        
        {% if artist and artist.lastfm_url %}
        <p class="artist-links"><a href="{{ artist.lastfm_url }}" target="_blank">View on Last.fm</a></p>
        {% endif %}
    </div>
</div>

{% if message %}
<div class="alert alert-success">{{ message }}</div>
{% endif %}

<div class="toolbar">
    <div class="sort-controls">
        <span>Sort by:</span>
        <a href="/artist/{{ artist_name | urlencode }}?sort=year&order={% if sort == 'year' and order == 'asc' %}desc{% else %}asc{% endif %}" 
           class="{% if sort == 'year' %}active{% endif %}">Year {% if sort == 'year' %}{{ '↑' if order == 'asc' else '↓' }}{% endif %}</a>
        <a href="/artist/{{ artist_name | urlencode }}?sort=title&order={% if sort == 'title' and order == 'asc' %}desc{% else %}asc{% endif %}" 
           class="{% if sort == 'title' %}active{% endif %}">Title {% if sort == 'title' %}{{ '↑' if order == 'asc' else '↓' }}{% endif %}</a>
    </div>
    <div class="toolbar-actions">
        <form action="/artist/{{ artist_name | urlencode }}/scrape" method="post" style="display: inline;">
            <button type="submit" class="btn">Refresh Profile</button>
        </form>
        <a href="/artist/{{ artist_name | urlencode }}/edit" class="btn">Edit Artist</a>
    </div>
</div>

{% if albums %}
<div class="album-grid">
    {% for album in albums %}
    <div class="album-card">
        <a href="{{ album_url(album) }}" class="album-cover">
            {% if album.cover_image_path %}
            <img src="{{ COVERS_URL }}{{ album.cover_image_path }}" alt="{{ album.title }}">
            {% else %}
            <div class="no-cover">No Cover</div>
            {% endif %}
        </a>
        <div class="album-info">
            <h3><a href="{{ album_url(album) }}">{{ album.title }}</a></h3>
            <p class="meta">
                {% if album.year %}<a href="/year/{{ album.year }}">{{ album.year }}</a>{% endif %}
                {% if album.physical_format %}<span class="format"><a href="/format/{{ album.physical_format }}">{{ album.physical_format }}</a></span>{% endif %}
            </p>
            {% if album.genres %}
            <p class="genres">
                {% for genre in album.genres[:3] %}
                <a href="/genre/{{ genre }}" class="tag">{{ genre }}</a>
                {% endfor %}
            </p>
            {% endif %}
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="empty-state">
    <p>No albums found for this artist.</p>
</div>
{% endif %}
{% endblock %}
